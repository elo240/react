{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\react\\\\front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"D:\\\\react\\\\front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"D:\\\\react\\\\front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _classCallCheck from\"D:\\\\react\\\\front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"D:\\\\react\\\\front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _assertThisInitialized from\"D:\\\\react\\\\front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"D:\\\\react\\\\front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"D:\\\\react\\\\front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from\"react\";import TextField from'@material-ui/core/TextField';import Button from'@material-ui/core/Button';import UserStore from\"./stores/UserStore\";var Forum=/*#__PURE__*/function(_React$Component){_inherits(Forum,_React$Component);var _super=_createSuper(Forum);function Forum(){var _this;_classCallCheck(this,Forum);_this=_super.call(this);_this.state={posts:[],newpost:\"\"};_this.handleChange=_this.handleChange.bind(_assertThisInitialized(_this));_this.handleSubmit=_this.handleSubmit.bind(_assertThisInitialized(_this));return _this;}_createClass(Forum,[{key:\"handleChange\",value:function handleChange(event){var target=event.target;var value=target.value;var name=target.name;this.setState(_defineProperty({},name,value));}},{key:\"handleSubmit\",value:function handleSubmit(event){event.preventDefault();if(this.state.newpost.trim().length>4){this.doSendNewPost();}else{alert(\"New post have to containd minimum of 5 characters\");}}},{key:\"doSendNewPost\",value:function(){var _doSendNewPost=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res,result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(\"/forum/newpost\",{method:\"post\",headers:{\"Accept\":\"application/json\",\"Content-Type\":\"application/json\"},body:JSON.stringify({userID:UserStore.userID,newpost:this.state.newpost})});case 3:res=_context.sent;_context.next=6;return res.json();case 6:result=_context.sent;console.log(result);if(result&&result.success){alert(\"Post added correctly\");this.forceUpdate();}else{alert(\"Error, please try again later\");}_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 14:case\"end\":return _context.stop();}}},_callee,this,[[0,11]]);}));function doSendNewPost(){return _doSendNewPost.apply(this,arguments);}return doSendNewPost;}()},{key:\"doRemove\",value:function(){var _doRemove=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(str){var postdata,res,result;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;postdata=str.split(\".\");_context2.next=4;return fetch(\"/forum/remove\",{method:\"post\",headers:{\"Accept\":\"application/json\",\"Content-Type\":\"application/json\"},body:JSON.stringify({postid:postdata[0],ownerid:postdata[1]})});case 4:res=_context2.sent;_context2.next=7;return res.json();case 7:result=_context2.sent;if(result&&result.success){alert(\"Post delted\");}else{alert(\"Error, please try again later\");}_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 14:case\"end\":return _context2.stop();}}},_callee2,null,[[0,11]]);}));function doRemove(_x){return _doRemove.apply(this,arguments);}return doRemove;}()},{key:\"updateForum\",value:function(){var _updateForum=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var _this2=this;var res,result,dbposts;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return fetch(\"/forum/load\",{method:\"post\",headers:{\"Accept\":\"application/json\",\"Content-Type\":\"application/json\"}});case 3:res=_context3.sent;_context3.next=6;return res.json();case 6:result=_context3.sent;if(result&&result.success){dbposts=result.body.map(function(post){if(UserStore.userID===post.user_id||UserStore.userID===1){return/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",null,post.id),/*#__PURE__*/React.createElement(\"td\",null,post.username),/*#__PURE__*/React.createElement(\"td\",null,post.body),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(Button,{onClick:function onClick(){return _this2.doRemove(\"\".concat(post.id,\".\").concat(post.user_id));}},\"Delete\")));}else{return/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",null,post.id),/*#__PURE__*/React.createElement(\"td\",null,post.username),/*#__PURE__*/React.createElement(\"td\",null,post.body),/*#__PURE__*/React.createElement(\"td\",null));}});this.setState({posts:dbposts});}else{alert(\"Couldnt connect please try again later\");}_context3.next=13;break;case 10:_context3.prev=10;_context3.t0=_context3[\"catch\"](0);console.log(_context3.t0);case 13:case\"end\":return _context3.stop();}}},_callee3,this,[[0,10]]);}));function updateForum(){return _updateForum.apply(this,arguments);}return updateForum;}()},{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:this.updateForum();case 1:case\"end\":return _context4.stop();}}},_callee4,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",{className:\"container-fluid\"},/*#__PURE__*/React.createElement(\"table\",{className:\"table\"},/*#__PURE__*/React.createElement(\"thead\",{className:\"thead-dark\"},/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"th\",null,\"#\"),/*#__PURE__*/React.createElement(\"th\",null,\"Author\"),/*#__PURE__*/React.createElement(\"th\",null,\"Post\"),/*#__PURE__*/React.createElement(\"th\",null,\"Mod\"))),this.state.posts,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",null),/*#__PURE__*/React.createElement(\"td\",null,UserStore.username),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(TextField,{name:\"newpost\",required:true,onChange:this.handleChange,placeholder:\"Your post\",type:\"textarea\",value:this.state.newpost})),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(Button,{variant:\"outlined\",onClick:this.handleSubmit},\"Submit\")))));}}]);return Forum;}(React.Component);export default Forum;","map":{"version":3,"sources":["D:/react/front/src/Forum.js"],"names":["React","TextField","Button","UserStore","Forum","state","posts","newpost","handleChange","bind","handleSubmit","event","target","value","name","setState","preventDefault","trim","length","doSendNewPost","alert","fetch","method","headers","body","JSON","stringify","userID","res","json","result","console","log","success","forceUpdate","str","postdata","split","postid","ownerid","dbposts","map","post","user_id","id","username","doRemove","updateForum","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Button from '@material-ui/core/Button';\r\nimport UserStore from \"./stores/UserStore\";\r\nclass Forum extends React.Component{\r\n    constructor(){\r\n        super();\r\n        this.state={\r\n            posts:[],\r\n            newpost:\"\"\r\n        };\r\n        this.handleChange=this.handleChange.bind(this);\r\n        this.handleSubmit=this.handleSubmit.bind(this);\r\n    }\r\n    handleChange(event){\r\n        const target = event.target;\r\n\t\tconst value = target.value;\r\n\t\tconst name = target.name;\r\n        this.setState({ [name]: value });\r\n    }\r\n    handleSubmit(event){\r\n        event.preventDefault();\r\n        if(this.state.newpost.trim().length>4){\r\n            this.doSendNewPost();\r\n        }else{\r\n            alert(\"New post have to containd minimum of 5 characters\")\r\n        }\r\n    }\r\n    async doSendNewPost(){\r\n        try{\r\n            let res= await fetch(\"/forum/newpost\",{\r\n                method: \"post\",\r\n                headers: {\r\n\t\t\t\t\t\"Accept\": \"application/json\",\r\n\t\t\t\t\t\"Content-Type\": \"application/json\",\r\n\t\t\t\t},body:JSON.stringify({\r\n                    userID:UserStore.userID,\r\n                    newpost:this.state.newpost\r\n                })\r\n            });\r\n            let result=await res.json();\r\n            console.log(result);\r\n            if(result && result.success){\r\n                alert(\"Post added correctly\");\r\n                this.forceUpdate();\r\n            }else{\r\n                alert(\"Error, please try again later\");\r\n            }\r\n        }catch(e){\r\n            console.log(e);\r\n        }\r\n    }\r\n    async doRemove(str){\r\n        try{\r\n            let postdata=str.split(\".\");\r\n            let res = await fetch(\"/forum/remove\", {\r\n\t\t\t\tmethod: \"post\",\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t\"Accept\": \"application/json\",\r\n\t\t\t\t\t\"Content-Type\": \"application/json\",\r\n\t\t\t\t},\r\n\t\t\t\tbody: JSON.stringify({\r\n\t\t\t\t\tpostid:postdata[0],\r\n\t\t\t\t\townerid:postdata[1]\r\n\t\t\t\t}),\r\n            });\r\n            let result= await res.json();\r\n            if(result && result.success){\r\n                alert(\"Post delted\");\r\n            }else{\r\n                alert(\"Error, please try again later\");\r\n            }\r\n        }catch(e){\r\n            console.log(e);\r\n        }\r\n\r\n    }\r\n    async updateForum(){\r\n        try{\r\n            let res=await fetch(\"/forum/load\",{\r\n                method: \"post\",\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t\"Accept\": \"application/json\",\r\n\t\t\t\t\t\"Content-Type\": \"application/json\",\r\n\t\t\t\t}, \r\n            });\r\n            let result=await res.json();\r\n            if(result && result.success){\r\n                const dbposts=result.body.map(post=>{\r\n                    if (UserStore.userID===post.user_id || UserStore.userID===1){\r\n                        return (<tr>\r\n                            <td>{post.id}</td>\r\n                            <td>{post.username}</td>\r\n                            <td>{post.body}</td>\r\n                            <td>\r\n                                <Button onClick={()=>this.doRemove(`${post.id}.${post.user_id}`)} >Delete</Button>\r\n                            </td>\r\n                            </tr>);\r\n                    }else{\r\n                        return (<tr>\r\n                            <td>{post.id}</td>\r\n                            <td>{post.username}</td>\r\n                            <td>{post.body}</td>\r\n                            <td></td>\r\n                            </tr>);\r\n                    }\r\n                })\r\n                this.setState({posts:dbposts});\r\n            }else{\r\n                alert(\"Couldnt connect please try again later\");\r\n            }\r\n        }catch(e){\r\n            console.log(e);\r\n        }\r\n    }\r\n    async componentDidMount(){\r\n        this.updateForum();\r\n        \r\n    }\r\n    render(){\r\n        return(\r\n            <div className=\"container-fluid\">\r\n                <table className=\"table\">\r\n                    <thead className=\"thead-dark\">\r\n                    <tr>\r\n                        <th>#</th>\r\n                        <th>Author</th>\r\n                        <th>Post</th>\r\n                        <th>Mod</th>\r\n                    </tr>\r\n                    </thead>\r\n                    {this.state.posts}\r\n                    <tr>\r\n                        <td></td>\r\n                        <td>{UserStore.username}</td>\r\n                        <td><TextField name=\"newpost\" required onChange={this.handleChange} placeholder=\"Your post\" type=\"textarea\" value={this.state.newpost} /></td>\r\n                        <td><Button variant=\"outlined\" onClick={this.handleSubmit}>Submit</Button></td>\r\n                </tr>\r\n                </table>\r\n            </div>\r\n        )  \r\n        ;\r\n    }\r\n}\r\nexport default Forum;"]},"metadata":{},"sourceType":"module"}